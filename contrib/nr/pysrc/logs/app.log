[ ERROR] 07-23-24 17:02:23 - train failed with error: Traceback (most recent call last):
  File "/Users/kevin/project_c++/neurdb_proj/neurdb-dev/contrib/nr/pysrc/app/handlers/setup.py", line 32, in train
    train_loader, val_loader, test_loader, nfields, nfeat = libsvm_dataloader(
  File "/Users/kevin/project_c++/neurdb_proj/neurdb-dev/contrib/nr/pysrc/dataloader/steam_libsvm_dataset.py", line 38, in libsvm_dataloader
    train_loader = DataLoader(data_loader,
  File "/Users/kevin/opt/anaconda3/envs/py38/lib/python3.8/site-packages/torch/utils/data/dataloader.py", line 224, in __init__
    sampler = RandomSampler(dataset, generator=generator)
  File "/Users/kevin/opt/anaconda3/envs/py38/lib/python3.8/site-packages/torch/utils/data/sampler.py", line 95, in __init__
    raise ValueError("num_samples should be a positive integer "
ValueError: num_samples should be a positive integer value, but got num_samples=0

[ ERROR] 07-23-24 21:00:10 - {"res":"NA","Errored":"Traceback (most recent call last):\n  File \"/Users/kevin/project_c++/neurdb_proj/neurdb-dev/contrib/nr/pysrc/app/routes/train.py\", line 24, in model_train\n    if not before_execute(dataset_name=dataset_name, data_key=Bufferkey.TRAIN_KEY, client_id=client_socket_id):\n  File \"/Users/kevin/project_c++/neurdb_proj/neurdb-dev/contrib/nr/pysrc/app/routes/context.py\", line 32, in before_execute\n    client = current_app.config['clients'][client_id]\nKeyError: 'W5YFg64d9FBnKtqmAAAB'\n"}
[ ERROR] 07-23-24 21:09:14 - {"res":"NA","Errored":"Traceback (most recent call last):\n  File \"/Users/kevin/project_c++/neurdb_proj/neurdb-dev/contrib/nr/pysrc/app/routes/train.py\", line 24, in model_train\n    if not before_execute(dataset_name=dataset_name, data_key=Bufferkey.TRAIN_KEY, client_id=client_socket_id):\n  File \"/Users/kevin/project_c++/neurdb_proj/neurdb-dev/contrib/nr/pysrc/app/routes/context.py\", line 32, in before_execute\n    client = current_app.config['clients'][client_id]\nKeyError: 'Rfoz89lBQXfr-oZiAAAB'\n"}
[ ERROR] 07-24-24 15:12:39 - train failed with error: Traceback (most recent call last):
  File "/Users/kevin/project_c++/neurdb_proj/neurdb-dev/contrib/nr/pysrc/app/handlers/setup.py", line 32, in train
    train_loader, val_loader, test_loader, nfields, nfeat = libsvm_dataloader(
  File "/Users/kevin/project_c++/neurdb_proj/neurdb-dev/contrib/nr/pysrc/dataloader/steam_libsvm_dataset.py", line 59, in libsvm_dataloader
    nfeat, nfields = data_loader.current_statistics()
  File "/Users/kevin/project_c++/neurdb_proj/neurdb-dev/contrib/nr/pysrc/dataloader/steam_libsvm_dataset.py", line 17, in current_statistics
    return self.data_cache.dataset_statistics()
TypeError: 'tuple' object is not callable

[ ERROR] 07-24-24 15:14:47 - train failed with error: Traceback (most recent call last):
  File "/Users/kevin/project_c++/neurdb_proj/neurdb-dev/contrib/nr/pysrc/app/handlers/setup.py", line 32, in train
    train_loader, val_loader, test_loader, nfields, nfeat = libsvm_dataloader(
  File "/Users/kevin/project_c++/neurdb_proj/neurdb-dev/contrib/nr/pysrc/dataloader/steam_libsvm_dataset.py", line 59, in libsvm_dataloader
    nfeat, nfields = data_loader.current_statistics()
  File "/Users/kevin/project_c++/neurdb_proj/neurdb-dev/contrib/nr/pysrc/dataloader/steam_libsvm_dataset.py", line 17, in current_statistics
    return self.data_cache.dataset_statistics()
TypeError: 'tuple' object is not callable

[ INFO] 07-24-24 15:18:32 - {'base_dir': './', 'model_repo': './', 'db_name': 'postgres', 'db_user': 'postgres', 'db_host': 'localhost', 'db_port': '5432', 'db_password': '123', 'server_port': '8090', 'data_loader_worker': 1, 'nfield': -1, 'nfeat': -1, 'nemb': 10, 'nattn_head': 4, 'alpha': 0.2, 'h': 8, 'mlp_nlayer': 2, 'mlp_nhid': 32, 'dropout': 0.5, 'ensemble': True, 'dnn_nlayer': 3, 'dnn_nhid': 256, 'epoch': 1, 'lr': 0.001, 'report_freq': 10, 'patience': 5, 'eval_freq': 100}
[ INFO] 07-24-24 15:18:35 - Epoch [  0/  1]
[ INFO] 07-24-24 15:22:58 - {'base_dir': './', 'model_repo': './', 'db_name': 'postgres', 'db_user': 'postgres', 'db_host': 'localhost', 'db_port': '5432', 'db_password': '123', 'server_port': '8090', 'data_loader_worker': 1, 'nfield': -1, 'nfeat': -1, 'nemb': 10, 'nattn_head': 4, 'alpha': 0.2, 'h': 8, 'mlp_nlayer': 2, 'mlp_nhid': 32, 'dropout': 0.5, 'ensemble': True, 'dnn_nlayer': 3, 'dnn_nhid': 256, 'epoch': 1, 'lr': 0.001, 'report_freq': 10, 'patience': 5, 'eval_freq': 100}
[ INFO] 07-24-24 15:22:58 - Epoch [  0/  1]
[ INFO] 07-24-24 15:26:04 - {'base_dir': './', 'model_repo': './', 'db_name': 'postgres', 'db_user': 'postgres', 'db_host': 'localhost', 'db_port': '5432', 'db_password': '123', 'server_port': '8090', 'data_loader_worker': 1, 'nfield': -1, 'nfeat': -1, 'nemb': 10, 'nattn_head': 4, 'alpha': 0.2, 'h': 8, 'mlp_nlayer': 2, 'mlp_nhid': 32, 'dropout': 0.5, 'ensemble': True, 'dnn_nlayer': 3, 'dnn_nhid': 256, 'epoch': 1, 'lr': 0.001, 'report_freq': 10, 'patience': 5, 'eval_freq': 100}
[ INFO] 07-24-24 15:26:04 - Epoch [  0/  1]
[ INFO] 07-24-24 15:29:00 - {'base_dir': './', 'model_repo': './', 'db_name': 'postgres', 'db_user': 'postgres', 'db_host': 'localhost', 'db_port': '5432', 'db_password': '123', 'server_port': '8090', 'data_loader_worker': 1, 'nfield': -1, 'nfeat': -1, 'nemb': 10, 'nattn_head': 4, 'alpha': 0.2, 'h': 8, 'mlp_nlayer': 2, 'mlp_nhid': 32, 'dropout': 0.5, 'ensemble': True, 'dnn_nlayer': 3, 'dnn_nhid': 256, 'epoch': 1, 'lr': 0.001, 'report_freq': 10, 'patience': 5, 'eval_freq': 100}
[ INFO] 07-24-24 15:29:00 - Epoch [  0/  1]
[ ERROR] 07-24-24 15:30:49 - train failed with error: Traceback (most recent call last):
  File "/Users/kevin/project_c++/neurdb_proj/neurdb-dev/contrib/nr/pysrc/app/handlers/setup.py", line 40, in train
    builder.train(train_loader, val_loader, test_loader)
  File "/Users/kevin/project_c++/neurdb_proj/neurdb-dev/contrib/nr/pysrc/models/armnet/builder.py", line 75, in train
    y = self._model(batch)
  File "/Users/kevin/opt/anaconda3/envs/py38/lib/python3.8/site-packages/torch/nn/modules/module.py", line 722, in _call_impl
    result = self.forward(*input, **kwargs)
  File "/Users/kevin/project_c++/neurdb_proj/neurdb-dev/contrib/nr/pysrc/models/armnet/model/model.py", line 89, in forward
    arm_weight = self.attn_layer(x_arm)  # bsz*nhead*nhid*nfield
  File "/Users/kevin/opt/anaconda3/envs/py38/lib/python3.8/site-packages/torch/nn/modules/module.py", line 722, in _call_impl
    result = self.forward(*input, **kwargs)
  File "/Users/kevin/project_c++/neurdb_proj/neurdb-dev/contrib/nr/pysrc/models/armnet/model/model.py", line 33, in forward
    att_gates = torch.einsum('bfx,kxy,koy->bkof',
  File "/Users/kevin/opt/anaconda3/envs/py38/lib/python3.8/site-packages/torch/functional.py", line 327, in einsum
    return _VF.einsum(equation, operands)
RuntimeError: dimension mismatch for operand 0: equation 3 tensor 4

[ INFO] 07-24-24 15:31:46 - {'base_dir': './', 'model_repo': './', 'db_name': 'postgres', 'db_user': 'postgres', 'db_host': 'localhost', 'db_port': '5432', 'db_password': '123', 'server_port': '8090', 'data_loader_worker': 1, 'nfield': -1, 'nfeat': -1, 'nemb': 10, 'nattn_head': 4, 'alpha': 0.2, 'h': 8, 'mlp_nlayer': 2, 'mlp_nhid': 32, 'dropout': 0.5, 'ensemble': True, 'dnn_nlayer': 3, 'dnn_nhid': 256, 'epoch': 1, 'lr': 0.001, 'report_freq': 10, 'patience': 5, 'eval_freq': 100}
[ INFO] 07-24-24 15:31:46 - Epoch [  0/  1]
[ INFO] 07-24-24 15:44:01 - {'base_dir': './', 'model_repo': './', 'db_name': 'postgres', 'db_user': 'postgres', 'db_host': 'localhost', 'db_port': '5432', 'db_password': '123', 'server_port': '8090', 'data_loader_worker': 1, 'nfield': -1, 'nfeat': -1, 'nemb': 10, 'nattn_head': 4, 'alpha': 0.2, 'h': 8, 'mlp_nlayer': 2, 'mlp_nhid': 32, 'dropout': 0.5, 'ensemble': True, 'dnn_nlayer': 3, 'dnn_nhid': 256, 'epoch': 1, 'lr': 0.001, 'report_freq': 10, 'patience': 5, 'eval_freq': 100}
[ INFO] 07-24-24 15:44:01 - Epoch [  0/  1]
[ INFO] 07-24-24 15:48:41 - {'base_dir': './', 'model_repo': './', 'db_name': 'postgres', 'db_user': 'postgres', 'db_host': 'localhost', 'db_port': '5432', 'db_password': '123', 'server_port': '8090', 'data_loader_worker': 1, 'nfield': -1, 'nfeat': -1, 'nemb': 10, 'nattn_head': 4, 'alpha': 0.2, 'h': 8, 'mlp_nlayer': 2, 'mlp_nhid': 32, 'dropout': 0.5, 'ensemble': True, 'dnn_nlayer': 3, 'dnn_nhid': 256, 'epoch': 1, 'lr': 0.001, 'report_freq': 10, 'patience': 5, 'eval_freq': 100}
[ INFO] 07-24-24 15:48:41 - Epoch [  0/  1]
[ ERROR] 07-24-24 15:49:57 - train failed with error: Traceback (most recent call last):
  File "/Users/kevin/project_c++/neurdb_proj/neurdb-dev/contrib/nr/pysrc/app/handlers/setup.py", line 40, in train
    builder.train(train_loader, val_loader, test_loader)
  File "/Users/kevin/project_c++/neurdb_proj/neurdb-dev/contrib/nr/pysrc/models/armnet/builder.py", line 75, in train
    y = self._model(batch)
  File "/Users/kevin/opt/anaconda3/envs/py38/lib/python3.8/site-packages/torch/nn/modules/module.py", line 722, in _call_impl
    result = self.forward(*input, **kwargs)
  File "/Users/kevin/project_c++/neurdb_proj/neurdb-dev/contrib/nr/pysrc/models/armnet/model/model.py", line 96, in forward
    y = self.mlp(x_arm)  # bsz*noutput
  File "/Users/kevin/opt/anaconda3/envs/py38/lib/python3.8/site-packages/torch/nn/modules/module.py", line 722, in _call_impl
    result = self.forward(*input, **kwargs)
  File "/Users/kevin/project_c++/neurdb_proj/neurdb-dev/contrib/nr/pysrc/models/armnet/model/layers.py", line 88, in forward
    return self.mlp(x)
  File "/Users/kevin/opt/anaconda3/envs/py38/lib/python3.8/site-packages/torch/nn/modules/module.py", line 722, in _call_impl
    result = self.forward(*input, **kwargs)
  File "/Users/kevin/opt/anaconda3/envs/py38/lib/python3.8/site-packages/torch/nn/modules/container.py", line 117, in forward
    input = module(input)
  File "/Users/kevin/opt/anaconda3/envs/py38/lib/python3.8/site-packages/torch/nn/modules/module.py", line 722, in _call_impl
    result = self.forward(*input, **kwargs)
  File "/Users/kevin/opt/anaconda3/envs/py38/lib/python3.8/site-packages/torch/nn/modules/batchnorm.py", line 131, in forward
    return F.batch_norm(
  File "/Users/kevin/opt/anaconda3/envs/py38/lib/python3.8/site-packages/torch/nn/functional.py", line 2012, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kevin/opt/anaconda3/envs/py38/lib/python3.8/site-packages/torch/nn/functional.py", line 1995, in _verify_batch_size
    raise ValueError('Expected more than 1 value per channel when training, got input size {}'.format(size))
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 32])

[ INFO] 07-24-24 15:51:54 - {'base_dir': './', 'model_repo': './', 'db_name': 'postgres', 'db_user': 'postgres', 'db_host': 'localhost', 'db_port': '5432', 'db_password': '123', 'server_port': '8090', 'data_loader_worker': 1, 'nfield': -1, 'nfeat': -1, 'nemb': 10, 'nattn_head': 4, 'alpha': 0.2, 'h': 8, 'mlp_nlayer': 2, 'mlp_nhid': 32, 'dropout': 0.5, 'ensemble': True, 'dnn_nlayer': 3, 'dnn_nhid': 256, 'epoch': 1, 'lr': 0.001, 'report_freq': 10, 'patience': 5, 'eval_freq': 100}
[ INFO] 07-24-24 15:51:54 - Epoch [  0/  1]
[ INFO] 07-24-24 15:59:11 - {'base_dir': './', 'model_repo': './', 'db_name': 'postgres', 'db_user': 'postgres', 'db_host': 'localhost', 'db_port': '5432', 'db_password': '123', 'server_port': '8090', 'data_loader_worker': 1, 'nfield': -1, 'nfeat': -1, 'nemb': 10, 'nattn_head': 4, 'alpha': 0.2, 'h': 8, 'mlp_nlayer': 2, 'mlp_nhid': 32, 'dropout': 0.5, 'ensemble': True, 'dnn_nlayer': 3, 'dnn_nhid': 256, 'epoch': 1, 'lr': 0.001, 'report_freq': 10, 'patience': 5, 'eval_freq': 100}
[ INFO] 07-24-24 15:59:11 - Epoch [  0/  1]
[ INFO] 07-24-24 15:59:30 - Epoch [  0/1][  0/1]	19.059 (19.059) AUC 1.000000 (1.000000) Loss   0.5733 (  0.5733)
[ INFO] 07-24-24 15:59:35 - train	Time    0h 0m 19s AUC   1.0000 Loss   0.5733
[ INFO] 07-24-24 16:00:31 - {'base_dir': './', 'model_repo': './', 'db_name': 'postgres', 'db_user': 'postgres', 'db_host': 'localhost', 'db_port': '5432', 'db_password': '123', 'server_port': '8090', 'data_loader_worker': 1, 'nfield': -1, 'nfeat': -1, 'nemb': 10, 'nattn_head': 4, 'alpha': 0.2, 'h': 8, 'mlp_nlayer': 2, 'mlp_nhid': 32, 'dropout': 0.5, 'ensemble': True, 'dnn_nlayer': 3, 'dnn_nhid': 256, 'epoch': 1, 'lr': 0.001, 'report_freq': 10, 'patience': 5, 'eval_freq': 100}
[ INFO] 07-24-24 16:00:31 - Epoch [  0/  1]
[ INFO] 07-24-24 16:01:45 - Epoch [  0/1][  0/1]	73.952 (73.952) AUC 0.250000 (0.250000) Loss   0.8005 (  0.8005)
[ INFO] 07-24-24 16:02:18 - train	Time    0h 1m 13s AUC   0.2500 Loss   0.8005
[ INFO] 07-24-24 16:40:12 - {'base_dir': './', 'model_repo': './', 'db_name': 'postgres', 'db_user': 'postgres', 'db_host': 'localhost', 'db_port': '5432', 'db_password': '123', 'server_port': '8090', 'data_loader_worker': 1, 'nfield': -1, 'nfeat': -1, 'nemb': 10, 'nattn_head': 4, 'alpha': 0.2, 'h': 8, 'mlp_nlayer': 2, 'mlp_nhid': 32, 'dropout': 0.5, 'ensemble': True, 'dnn_nlayer': 3, 'dnn_nhid': 256, 'epoch': 1, 'lr': 0.001, 'report_freq': 10, 'patience': 5, 'eval_freq': 100}
[ INFO] 07-24-24 16:40:15 - Epoch [  0/  1]
[ ERROR] 07-24-24 16:40:37 - train failed with error: Traceback (most recent call last):
  File "/Users/kevin/project_c++/neurdb_proj/neurdb-dev/contrib/nr/pysrc/app/handlers/setup.py", line 40, in train
    builder.train(train_loader, val_loader, test_loader)
  File "/Users/kevin/project_c++/neurdb_proj/neurdb-dev/contrib/nr/pysrc/models/armnet/builder.py", line 94, in train
    f"Epoch [{epoch:3d}/{self.args.epoch}][{batch_idx:3d}/{len(train_loader)}]\t"
TypeError: object of type 'StreamingDataSet' has no len()

[ ERROR] 07-24-24 17:03:54 - {"res":"NA","Errored":"Traceback (most recent call last):\n  File \"/Users/kevin/project_c++/neurdb_proj/neurdb-dev/contrib/nr/pysrc/app/routes/train.py\", line 27, in model_train\n    if not before_execute(dataset_name=dataset_name, data_key=Bufferkey.TRAIN_KEY, client_id=client_socket_id):\n  File \"/Users/kevin/project_c++/neurdb_proj/neurdb-dev/contrib/nr/pysrc/app/routes/context.py\", line 33, in before_execute\n    client = current_app.config['clients'][client_id]\nKeyError: 'OGIu1oJWP_47KwaQAAAB'\n"}
[ ERROR] 07-24-24 17:03:54 - {"res":"NA","Errored":"Traceback (most recent call last):\n  File \"/Users/kevin/project_c++/neurdb_proj/neurdb-dev/contrib/nr/pysrc/app/routes/inference.py\", line 18, in model_inference\n    batch_size = int(params.get(\"batch_size\"))\nTypeError: int() argument must be a string, a bytes-like object or a number, not 'NoneType'\n"}
[ INFO] 07-24-24 17:04:28 - {'base_dir': './', 'model_repo': './', 'db_name': 'postgres', 'db_user': 'postgres', 'db_host': 'localhost', 'db_port': '5432', 'db_password': '123', 'server_port': '8090', 'data_loader_worker': 1, 'nfield': -1, 'nfeat': -1, 'nemb': 10, 'nattn_head': 4, 'alpha': 0.2, 'h': 8, 'mlp_nlayer': 2, 'mlp_nhid': 32, 'dropout': 0.5, 'ensemble': True, 'dnn_nlayer': 3, 'dnn_nhid': 256, 'epoch': 1, 'lr': 0.001, 'report_freq': 10, 'patience': 5, 'eval_freq': 100}
[ INFO] 07-24-24 17:04:37 - Epoch [  0/  1]
[ INFO] 07-24-24 17:05:19 - Epoch [  0/1][  0/3]	42.257 (42.257) AUC 0.750000 (0.750000) Loss   0.6903 (  0.6903)
[ INFO] 07-24-24 17:09:54 - {'base_dir': './', 'model_repo': './', 'db_name': 'postgres', 'db_user': 'postgres', 'db_host': 'localhost', 'db_port': '5432', 'db_password': '123', 'server_port': '8090', 'data_loader_worker': 1, 'nfield': -1, 'nfeat': -1, 'nemb': 10, 'nattn_head': 4, 'alpha': 0.2, 'h': 8, 'mlp_nlayer': 2, 'mlp_nhid': 32, 'dropout': 0.5, 'ensemble': True, 'dnn_nlayer': 3, 'dnn_nhid': 256, 'epoch': 1, 'lr': 0.001, 'report_freq': 10, 'patience': 5, 'eval_freq': 100}
[ INFO] 07-24-24 17:09:55 - Epoch [  0/  1]
[ INFO] 07-24-24 17:10:05 - Epoch [  0/1][  0/3]	10.389 (10.389) AUC 0.416667 (0.416667) Loss   0.8462 (  0.8462)
[ INFO] 07-24-24 17:11:56 - {'base_dir': './', 'model_repo': './', 'db_name': 'postgres', 'db_user': 'postgres', 'db_host': 'localhost', 'db_port': '5432', 'db_password': '123', 'server_port': '8090', 'data_loader_worker': 1, 'nfield': -1, 'nfeat': -1, 'nemb': 10, 'nattn_head': 4, 'alpha': 0.2, 'h': 8, 'mlp_nlayer': 2, 'mlp_nhid': 32, 'dropout': 0.5, 'ensemble': True, 'dnn_nlayer': 3, 'dnn_nhid': 256, 'epoch': 1, 'lr': 0.001, 'report_freq': 10, 'patience': 5, 'eval_freq': 100}
[ INFO] 07-24-24 17:11:57 - Epoch [  0/  1]
[ INFO] 07-24-24 17:12:14 - Epoch [  0/1][  0/3]	16.517 (16.517) AUC 0.500000 (0.500000) Loss   0.6641 (  0.6641)
[ INFO] 07-24-24 17:14:17 - train	Time    0h 2m 10s AUC   0.6111 Loss   0.6078
[ INFO] 07-24-24 17:14:59 - val	Epoch [  0/3]	34.608 (34.608) AUC 0.750000 (0.750000) Loss   0.6795 (  0.6795)
[ INFO] 07-24-24 17:32:54 - {'base_dir': './', 'model_repo': './', 'db_name': 'postgres', 'db_user': 'postgres', 'db_host': 'localhost', 'db_port': '5432', 'db_password': '123', 'server_port': '8090', 'data_loader_worker': 1, 'nfield': -1, 'nfeat': -1, 'nemb': 10, 'nattn_head': 4, 'alpha': 0.2, 'h': 8, 'mlp_nlayer': 2, 'mlp_nhid': 32, 'dropout': 0.5, 'ensemble': True, 'dnn_nlayer': 3, 'dnn_nhid': 256, 'epoch': 1, 'lr': 0.001, 'report_freq': 10, 'patience': 5, 'eval_freq': 100}
[ INFO] 07-24-24 17:32:59 - Epoch [  0/  1]
[ INFO] 07-24-24 17:33:01 - Epoch [  0/1][  0/3]	1.802 (1.802) AUC 0.916667 (0.916667) Loss   0.6452 (  0.6452)
[ INFO] 07-24-24 17:33:14 - train	Time    0h 0m 13s AUC   0.8056 Loss   0.6509
[ INFO] 07-24-24 17:33:32 - val	Epoch [  0/3]	8.104 (8.104) AUC 0.833333 (0.833333) Loss   0.6914 (  0.6914)
[ INFO] 07-24-24 17:33:35 - val	Time     0h 0m 9s AUC   0.8333 Loss   0.6914
[ INFO] 07-24-24 17:33:38 - test	Epoch [  0/3]	3.689 (3.689) AUC 0.833333 (0.833333) Loss   0.6914 (  0.6914)
[ INFO] 07-24-24 17:34:12 - test	Time    0h 0m 26s AUC   0.8333 Loss   0.6914
[ INFO] 07-24-24 17:34:31 - best valid auc: valid 0.8333, test 0.8333
[ INFO] 07-24-24 17:35:00 - Total running time for training/validation/test: 0h 1m 39s
[ ERROR] 07-24-24 17:35:10 - train failed with error: Traceback (most recent call last):
  File "/Users/kevin/project_c++/neurdb_proj/neurdb-dev/contrib/nr/pysrc/app/handlers/setup.py", line 46, in train
    model_id = self._db.insert_model(builder.model)
AttributeError: 'NoneType' object has no attribute 'insert_model'

[ ERROR] 07-24-24 17:35:13 - {"res":"NA","Errored":"Traceback (most recent call last):\n  File \"/Users/kevin/project_c++/neurdb_proj/neurdb-dev/contrib/nr/pysrc/app/routes/inference.py\", line 18, in model_inference\n    batch_size = int(params.get(\"batch_size\"))\nTypeError: int() argument must be a string, a bytes-like object or a number, not 'NoneType'\n"}
[ INFO] 07-24-24 20:35:02 - {'base_dir': './', 'model_repo': './', 'db_name': 'postgres', 'db_user': 'postgres', 'db_host': 'localhost', 'db_port': '5432', 'db_password': '123', 'server_port': '8090', 'data_loader_worker': 1, 'nfield': -1, 'nfeat': -1, 'nemb': 10, 'nattn_head': 4, 'alpha': 0.2, 'h': 8, 'mlp_nlayer': 2, 'mlp_nhid': 32, 'dropout': 0.5, 'ensemble': True, 'dnn_nlayer': 3, 'dnn_nhid': 256, 'epoch': 1, 'lr': 0.001, 'report_freq': 10, 'patience': 5, 'eval_freq': 100}
[ INFO] 07-24-24 20:35:04 - Epoch [  0/  1]
[ INFO] 07-24-24 20:35:08 - Epoch [  0/1][  0/3]	4.687 (4.687) AUC 0.333333 (0.333333) Loss   0.6808 (  0.6808)
[ INFO] 07-24-24 20:35:20 - train	Time    0h 0m 14s AUC   0.4444 Loss   0.6994
[ INFO] 07-24-24 20:35:23 - val	Epoch [  0/3]	1.968 (1.968) AUC 0.583333 (0.583333) Loss   0.7094 (  0.7094)
[ INFO] 07-24-24 20:35:23 - val	Time     0h 0m 1s AUC   0.5833 Loss   0.7094
[ INFO] 07-24-24 20:35:23 - test	Epoch [  0/3]	0.015 (0.015) AUC 0.583333 (0.583333) Loss   0.7094 (  0.7094)
[ INFO] 07-24-24 20:35:23 - test	Time     0h 0m 0s AUC   0.5833 Loss   0.7094
[ INFO] 07-24-24 20:35:23 - best valid auc: valid 0.5833, test 0.5833
[ INFO] 07-24-24 20:35:29 - Total running time for training/validation/test: 0h 0m 26s
[ ERROR] 07-24-24 20:35:32 - train failed with error: Traceback (most recent call last):
  File "/Users/kevin/project_c++/neurdb_proj/neurdb-dev/contrib/nr/pysrc/app/handlers/setup.py", line 46, in train
    model_id = self._db.insert_model(builder.model)
AttributeError: 'NoneType' object has no attribute 'insert_model'

[ ERROR] 07-24-24 20:35:32 - {"res":"NA","Errored":"Traceback (most recent call last):\n  File \"/Users/kevin/project_c++/neurdb_proj/neurdb-dev/contrib/nr/pysrc/app/routes/inference.py\", line 18, in model_inference\n    batch_size = int(params.get(\"batch_size\"))\nTypeError: int() argument must be a string, a bytes-like object or a number, not 'NoneType'\n"}
[ ERROR] 07-24-24 21:54:45 - {"res":"NA","Errored":"Traceback (most recent call last):\n  File \"/Users/kevin/project_c++/neurdb_proj/neurdb-dev/contrib/nr/pysrc/app/routes/train.py\", line 29, in model_train\n    exe_flag, exe_info = before_execute(dataset_name=dataset_name, data_key=Bufferkey.TRAIN_KEY,\n  File \"/Users/kevin/project_c++/neurdb_proj/neurdb-dev/contrib/nr/pysrc/app/routes/context.py\", line 32, in before_execute\n    if client_id not in data_cache:\nTypeError: argument of type 'ContextStates' is not iterable\n"}
[ ERROR] 07-24-24 21:54:45 - {"res":"NA","Errored":"Traceback (most recent call last):\n  File \"/Users/kevin/project_c++/neurdb_proj/neurdb-dev/contrib/nr/pysrc/app/routes/inference.py\", line 18, in model_inference\n    batch_size = int(params.get(\"batch_size\"))\nTypeError: int() argument must be a string, a bytes-like object or a number, not 'NoneType'\n"}
[ ERROR] 07-24-24 21:57:57 - {"res":"NA","Errored":"Traceback (most recent call last):\n  File \"/Users/kevin/project_c++/neurdb_proj/neurdb-dev/contrib/nr/pysrc/app/routes/inference.py\", line 18, in model_inference\n    batch_size = int(params.get(\"batch_size\"))\nTypeError: int() argument must be a string, a bytes-like object or a number, not 'NoneType'\n"}
[ ERROR] 07-24-24 21:58:38 - {"res":"NA","Errored":"Traceback (most recent call last):\n  File \"/Users/kevin/project_c++/neurdb_proj/neurdb-dev/contrib/nr/pysrc/app/routes/inference.py\", line 18, in model_inference\n    batch_size = int(params.get(\"batch_size\"))\nTypeError: int() argument must be a string, a bytes-like object or a number, not 'NoneType'\n"}
[ ERROR] 07-24-24 22:01:47 - {"res":"NA","Errored":"Traceback (most recent call last):\n  File \"/Users/kevin/project_c++/neurdb_proj/neurdb-dev/contrib/nr/pysrc/app/routes/inference.py\", line 18, in model_inference\n    batch_size = int(params.get(\"batch_size\"))\nTypeError: int() argument must be a string, a bytes-like object or a number, not 'NoneType'\n"}
[ INFO] 07-24-24 22:02:36 - {'base_dir': './', 'model_repo': './', 'db_name': 'postgres', 'db_user': 'postgres', 'db_host': 'localhost', 'db_port': '5432', 'db_password': '123', 'server_port': '8090', 'data_loader_worker': 1, 'nfield': -1, 'nfeat': -1, 'nemb': 10, 'nattn_head': 4, 'alpha': 0.2, 'h': 8, 'mlp_nlayer': 2, 'mlp_nhid': 32, 'dropout': 0.5, 'ensemble': True, 'dnn_nlayer': 3, 'dnn_nhid': 256, 'epoch': 1, 'lr': 0.001, 'report_freq': 10, 'patience': 5, 'eval_freq': 100}
[ INFO] 07-24-24 22:02:36 - Epoch [  0/  1]
[ INFO] 07-24-24 22:02:37 - Epoch [  0/1][  0/3]	1.597 (1.597) AUC 0.250000 (0.250000) Loss   0.8905 (  0.8905)
[ INFO] 07-24-24 22:03:05 - {'base_dir': './', 'model_repo': './', 'db_name': 'postgres', 'db_user': 'postgres', 'db_host': 'localhost', 'db_port': '5432', 'db_password': '123', 'server_port': '8090', 'data_loader_worker': 1, 'nfield': -1, 'nfeat': -1, 'nemb': 10, 'nattn_head': 4, 'alpha': 0.2, 'h': 8, 'mlp_nlayer': 2, 'mlp_nhid': 32, 'dropout': 0.5, 'ensemble': True, 'dnn_nlayer': 3, 'dnn_nhid': 256, 'epoch': 1, 'lr': 0.001, 'report_freq': 10, 'patience': 5, 'eval_freq': 100}
[ INFO] 07-24-24 22:03:05 - Epoch [  0/  1]
[ INFO] 07-24-24 22:03:06 - Epoch [  0/1][  0/3]	1.052 (1.052) AUC 0.500000 (0.500000) Loss   0.7162 (  0.7162)
[ INFO] 07-24-24 22:03:08 - train	Time     0h 0m 3s AUC   0.6944 Loss   0.6906
[ INFO] 07-24-24 22:03:09 - val	Epoch [  0/3]	0.027 (0.027) AUC 0.916667 (0.916667) Loss   0.6944 (  0.6944)
[ INFO] 07-24-24 22:03:09 - val	Time     0h 0m 0s AUC   0.9167 Loss   0.6944
[ INFO] 07-24-24 22:03:09 - test	Epoch [  0/3]	0.011 (0.011) AUC 0.916667 (0.916667) Loss   0.6944 (  0.6944)
[ INFO] 07-24-24 22:03:09 - test	Time     0h 0m 0s AUC   0.9167 Loss   0.6944
[ INFO] 07-24-24 22:03:09 - best valid auc: valid 0.9167, test 0.9167
[ INFO] 07-24-24 22:03:09 - Total running time for training/validation/test: 0h 0m 4s
[ ERROR] 07-24-24 22:03:09 - train failed with error: Traceback (most recent call last):
  File "/Users/kevin/project_c++/neurdb_proj/neurdb-dev/contrib/nr/pysrc/app/handlers/setup.py", line 46, in train
    model_id = self._db.insert_model(builder.model)
AttributeError: 'NoneType' object has no attribute 'insert_model'

[ ERROR] 07-24-24 22:03:09 - {"res":"NA","Errored":"Traceback (most recent call last):\n  File \"/Users/kevin/project_c++/neurdb_proj/neurdb-dev/contrib/nr/pysrc/app/routes/inference.py\", line 18, in model_inference\n    batch_size = int(params.get(\"batch_size\"))\nTypeError: int() argument must be a string, a bytes-like object or a number, not 'NoneType'\n"}
[ INFO] 07-25-24 00:09:42 - {'base_dir': './', 'model_repo': './', 'db_name': 'postgres', 'db_user': 'postgres', 'db_host': 'localhost', 'db_port': '5432', 'db_password': '123', 'server_port': '8090', 'data_loader_worker': 1, 'nfield': -1, 'nfeat': -1, 'nemb': 10, 'nattn_head': 4, 'alpha': 0.2, 'h': 8, 'mlp_nlayer': 2, 'mlp_nhid': 32, 'dropout': 0.5, 'ensemble': True, 'dnn_nlayer': 3, 'dnn_nhid': 256, 'epoch': 1, 'lr': 0.001, 'report_freq': 10, 'patience': 5, 'eval_freq': 100}
[ INFO] 07-25-24 00:09:42 - Epoch [  0/  1]
